<html xmlns:th="http://www.thymeleaf.org" th:replace="layout">
 <div th:fragment="content">
  <div class="container-fluid">

   <!-- Breadcrumbs-->
   <ol class="breadcrumb">
    <li class="breadcrumb-item">
     <a href="/admin">首页</a>
    </li>
    <li class="breadcrumb-item">
     <a href="/admin/orderlist">订单管理</a>
    </li>
    <li class="breadcrumb-item active">订单详情</li>
   </ol>

   <!-- DataTables Example -->
   <div class="card mb-3">
    <div class="card-header">
     <i class="fas fa-plane"></i>
     订单流程
    </div>
    <div class="card-body">
     <div class="row">
      <div class="col-sm-3">
      </div>
      <div id="yestep" class="ystep"></div>
     </div>
    </div>
   </div>
   <div class="card mb-3">
    <div class="card-header">
     <i class="fas fa-bell"></i>
     <span class="alert alert-danger" th:switch="${orderDetail.status}">
        当前订单状态：
        <b th:case="0">待付款</b>
        <b th:case="1">待发货</b>
        <b th:case="2">已发货</b>
        <b th:case="3">已完成</b>
        <b th:case="4">已关闭</b>
        <b th:case="5">无效订单</b>
       </span>
    </div>
   </div>

   <div class="card mb-3">
    <div class="card-header">
     <i class="fas fa-map"></i>
     基本信息
    </div>
    <div class="card-body">
     <div class="table-responsive">
      <table class="table table-bordered" id="order_info" width="100%" cellspacing="0">
       <thead>
       <tr>
        <th>订单编号</th>
        <th>用户账号</th>
        <th>支付方式</th>
        <th>物流单号</th>
        <th>总 价</th>
       </tr>
       </thead>
       <tbody>
       <tr>
        <td th:text="${orderDetail.orderSn}"></td>
        <td th:text="${orderDetail.memberUsername}"></td>
        <!--支付方式：0->未支付；1->支付宝；2->微信-->
        <td th:switch="${orderDetail.payType}">
         <span th:case="0">未支付</span>
         <span th:case="1">支付宝</span>
         <span th:case="2">微信</span>
        </td>
        <td th:text="${orderDetail.deliverySn}"></td>
        <th th:text="${orderDetail.payAmount}"></th>
       </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
   <div class="card mb-3">
    <div class="card-header">
     <i class="fas fa-map"></i>
     收货人信息
    </div>
    <div class="card-body">
     <div class="table-responsive">
      <table class="table table-bordered" id="order_receiver" width="100%" cellspacing="0">
       <thead>
       <tr>
        <th>收货人姓名</th>
        <th>联系方式</th>
        <th>邮政编码</th>
        <th>收获地址</th>
       </tr>
       </thead>
       <tbody>
       <tr>
        <td th:text="${orderDetail.receiverName}"></td>
        <td th:text="${orderDetail.receiverPhone}"></td>
        <td th:text="${orderDetail.receiverPostCode}"></td>
        <td th:text="${orderDetail.receiverProvince}+${orderDetail.receiverCity}+${orderDetail.receiverRegion}+${orderDetail.receiverDetailAddress}"></td>
       </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
   <div class="card mb-3">
    <div class="card-header">
     <i class="fas fa-map"></i>
     商品信息
    </div>
    <div class="card-body">
     <div class="table-responsive">
      <table class="table table-bordered" id="order_good" width="100%" cellspacing="0">
       <thead>
       <tr>
        <th>图 片</th>
        <th>名 称</th>
        <th>价 格</th>
        <th>货 号</th>
        <th>属 性</th>
        <th>数 量</th>
        <th>小 计</th>
       </tr>
       </thead>
       <tbody>
       <tr class="text-center" th:style="${#lists.isEmpty(orderDetail.orderItemList)?'':'display:none'}">
        <td colspan="7">暂无数据</td>
       </tr>
       <tr th:each="order:${orderDetail.orderItemList}">
        <td>
         <img th:src="${order.productPic}" th:width="80" th:height="80">
        </td>
        <td th:text="${order.productName}"></td>
        <td th:text="${order.productPrice}"></td>
        <td th:text="${order.productSn}"></td>
        <td th:text="${order.productAttr}"></td>
        <td th:text="${order.productQuantity}"></td>
        <td th:text="${order.productPrice} * ${order.productQuantity}"></td>
       </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
   <div class="card mb-3">
    <div class="card-header">
     <i class="fas fa-map"></i>
     费用信息
    </div>
    <div class="card-body">
     <div class="table-responsive">
      <table class="table table-bordered" id="order_fee" width="100%" cellspacing="0">
       <thead>
        <tr>
         <th>商品合计</th>
         <th>运 费</th>
         <th>优惠券</th>
         <th>积分抵扣</th>
        </tr>
       </thead>
      <tbody>
       <tr>
        <td th:text="${orderDetail.totalAmount}"></td>
        <td th:text="${orderDetail.freightAmount}"></td>
        <td th:text="'-'+${orderDetail.couponAmount}"></td>
        <td th:text="'-'+${orderDetail.integrationAmount}"></td>
       </tr>
       </tbody>
       <thead>
       <tr>
        <th>活动优惠</th>
        <th>折扣金额</th>
        <th>订单总金额</th>
        <th>应付款金额</th>
       </tr>
       </thead>
       <tbody>
       <tr>
        <td th:text="'-'+${orderDetail.promotionAmount}"></td>
        <td th:text="'-'+${orderDetail.discountAmount}"></td>
        <td th:text="${orderDetail.totalAmount}+${orderDetail.freightAmount}"></td>
        <td th:text="${orderDetail.payAmount}"></td>
       </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
   <div class="card mb-3">
    <div class="card-header">
     <i class="fas fa-map"></i>
     操作员信息
    </div>
    <div class="card-body">
     <div class="table-responsive">
      <table class="table table-bordered" id="order_operator" width="100%" cellspacing="0">
       <thead>
       <tr>
        <th>操作者</th>
        <th>操作时间</th>
        <th>订单状态</th>
        <th>备 注</th>
       </tr>
       </thead>
       <tbody>
       <tr class="text-center" th:style="${#lists.isEmpty(orderDetail.historyList)?'':'display:none'}">
        <td colspan="4">暂无数据</td>
       </tr>
       <tr th:each="history:${orderDetail.historyList}">
        <td th:text="${history.operateMan}"></td>
        <td th:text="${#dates.format(history.createTime,'yyyy-MM-dd HH:mm:ss')}"></td>
        <td th:switch="${history.orderStatus}">
         <span th:case="0">待付款</span>
         <span th:case="1">待发货</span>
         <span th:case="2">已发货</span>
         <span th:case="3">已完成</span>
         <span th:case="4">已关闭</span>
         <span th:case="5">无效订单</span>
        </td>
        <td th:text="${history.note}"></td>
       </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
  </div>
  <!-- /.container-fluid -->
   <!-- Bootstrap core JavaScript-->
   <script th:src="@{/vendor/jquery/jquery.min.js}"></script>
   <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>

   <!-- Core plugin JavaScript-->
   <script th:src="@{/vendor/jquery-easing/jquery.easing.min.js}"></script>

   <!-- Page level plugin JavaScript-->
   <script th:src="@{/vendor/chart.js/Chart.min.js}"></script>
   <script th:src="@{/vendor/datatables/jquery.dataTables.js}"></script>
   <script th:src="@{/vendor/datatables/dataTables.bootstrap4.js}"></script>

   <!-- Custom scripts for all pages-->
   <script th:src="@{/js/sb-admin.min.js}"></script>
   <!-- Data scripts for this page-->
   <script th:src="@{/js/ystep.js}"></script>
   <script th:inline="javascript">
    // 订单状态：0->待付款；1->待发货；2->已发货；3->已完成；4->已关闭；5->无效订单
    var step = [[${orderDetail.status}]];
    if (step == 5) {
        step = 0;
    }
    var create_time = [[${#dates.format(orderDetail.createTime,'yyyy-MM-dd HH:mm:ss')}]];
    $(".ystep").loadStep({
        size: "large",
        color: "green",
        steps: [{
            title: "提交订单",
            content: create_time
        },{
            title: "支付订单",
            content: "待发货"
        },{
            title: "平台发货",
            content: "已发货"
        },{
            title: "确认收货",
            content: "已完成"
        },{
            title: "完成评价",
            content: "已关闭"
        }]
    });

    $(".ystep").setStep(step+1);
   </script>
 </div>
</html>